<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Kam Tin Seong Assoc. Professor of Information Systems(Practice)">
<meta name="dcterms.date" content="2023-02-12">

<title>IS415 AY2022-23T2 - Lesson 6: Spatial Weights and Applications</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415 AY2022-23T2</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../syllabus.html">
 <span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../lesson.html">
 <span class="menu-text">Lesson Plan</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../th_ex1.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../th_ex2.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../th_ex3.html">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../GAproject.html">
 <span class="menu-text">Geospatial Analytics Project</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-shiny-workshop" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Shiny Workshop</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-shiny-workshop">    
        <li>
    <a class="dropdown-item" href="../../ShinyWorkshop/Shiny1/Shiny1.html">
 <span class="dropdown-text">R Shiny basic</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ShinyWorkshop/Shiny2/Shiny2.html">
 <span class="dropdown-text">Beyond the basic</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ShinyWorkshop/Shiny3/Shiny3.html">
 <span class="dropdown-text">Customising Shiny</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../ShinyResources.html">
 <span class="dropdown-text">Shiny Resources</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../quarto.html">
 <span class="menu-text">All About Quarto</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#content" id="toc-content" class="nav-link active" data-scroll-target="#content">Content</a>
  <ul class="collapse">
  <li><a href="#what-is-geographically-referenced-attribute" id="toc-what-is-geographically-referenced-attribute" class="nav-link" data-scroll-target="#what-is-geographically-referenced-attribute">What is geographically referenced attribute?</a>
  <ul class="collapse">
  <li><a href="#describing-attribute-distribution" id="toc-describing-attribute-distribution" class="nav-link" data-scroll-target="#describing-attribute-distribution">Describing attribute distribution</a></li>
  <li><a href="#geographical-distribution-question" id="toc-geographical-distribution-question" class="nav-link" data-scroll-target="#geographical-distribution-question">Geographical distribution question</a></li>
  <li><a href="#geographical-distribution-question-1" id="toc-geographical-distribution-question-1" class="nav-link" data-scroll-target="#geographical-distribution-question-1">Geographical distribution question</a></li>
  </ul></li>
  <li><a href="#what-are-spatial-weights-wij" id="toc-what-are-spatial-weights-wij" class="nav-link" data-scroll-target="#what-are-spatial-weights-wij">What are Spatial Weights <em>(wij)</em></a>
  <ul class="collapse">
  <li><a href="#defining-spatial-weights" id="toc-defining-spatial-weights" class="nav-link" data-scroll-target="#defining-spatial-weights">Defining Spatial Weights</a></li>
  <li><a href="#contiguity-neighbours" id="toc-contiguity-neighbours" class="nav-link" data-scroll-target="#contiguity-neighbours">Contiguity Neighbours</a></li>
  <li><a href="#beyond-the-basic-contiguity-neighbours" id="toc-beyond-the-basic-contiguity-neighbours" class="nav-link" data-scroll-target="#beyond-the-basic-contiguity-neighbours">Beyond the basic contiguity neighbours</a></li>
  <li><a href="#weights-matrix-adjacency-based-neighbours" id="toc-weights-matrix-adjacency-based-neighbours" class="nav-link" data-scroll-target="#weights-matrix-adjacency-based-neighbours">Weights matrix: Adjacency-based neighbours</a></li>
  <li><a href="#weights-matrix-distance-based-neighbours" id="toc-weights-matrix-distance-based-neighbours" class="nav-link" data-scroll-target="#weights-matrix-distance-based-neighbours">Weights Matrix: Distance-based neighbours</a></li>
  <li><a href="#weights-matrix-measured-distances" id="toc-weights-matrix-measured-distances" class="nav-link" data-scroll-target="#weights-matrix-measured-distances">Weights matrix: Measured distances</a></li>
  <li><a href="#row-standardisation" id="toc-row-standardisation" class="nav-link" data-scroll-target="#row-standardisation">Row standardisation</a></li>
  </ul></li>
  <li><a href="#applications-of-spatial-weights" id="toc-applications-of-spatial-weights" class="nav-link" data-scroll-target="#applications-of-spatial-weights">Applications of Spatial Weights</a>
  <ul class="collapse">
  <li><a href="#spatially-lagged-variables" id="toc-spatially-lagged-variables" class="nav-link" data-scroll-target="#spatially-lagged-variables">Spatially Lagged Variables</a></li>
  <li><a href="#spatial-window-sum" id="toc-spatial-window-sum" class="nav-link" data-scroll-target="#spatial-window-sum">Spatial window sum</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lesson 6: Spatial Weights and Applications</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    Dr.&nbsp;Kam Tin Seong<br>Assoc. Professor of Information Systems(Practice) 
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            School of Computing and Information Systems,<br>Singapore Management University
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">12 Feb 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="content" class="level1">
<h1>Content</h1>
<ul>
<li>Introduction to Spatial Weights</li>
<li>Contiguity-Based Spatial Weights
<ul>
<li>Rook’s</li>
<li>Queen’s</li>
</ul></li>
<li>Distance-Band Spatial Weights</li>
<li>Applications of Spatial Weights</li>
</ul>
<div class="notes">
<p>This lesson consists of three main sections. First, I am going to explain the basic concept of spatial weights. This is followed by a discussion on various methods used to compute spatial weights. Lastly, the applications of spatial wiehgts will be discussed.</p>
</div>
<section id="what-is-geographically-referenced-attribute" class="level2">
<h2 class="anchored" data-anchor-id="what-is-geographically-referenced-attribute">What is geographically referenced attribute?</h2>
<div class="cell">

</div>
<div class="cell" data-highlight.output="[9,10,11,12,13]">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>geodemog <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/geodemog.RDS"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(geodemog)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 323
Columns: 12
$ SUBZONE_N        &lt;chr&gt; "MARINA SOUTH", "PEARL'S HILL", "BOAT QUAY", "HENDERS…
$ SUBZONE_C        &lt;fct&gt; MSSZ01, OTSZ01, SRSZ03, BMSZ08, BMSZ03, BMSZ07, BMSZ0…
$ PLN_AREA_N       &lt;fct&gt; MARINA SOUTH, OUTRAM, SINGAPORE RIVER, BUKIT MERAH, B…
$ PLN_AREA_C       &lt;fct&gt; MS, OT, SR, BM, BM, BM, BM, SR, QT, QT, QT, BM, ME, R…
$ REGION_N         &lt;fct&gt; CENTRAL REGION, CENTRAL REGION, CENTRAL REGION, CENTR…
$ REGION_C         &lt;fct&gt; CR, CR, CR, CR, CR, CR, CR, CR, CR, CR, CR, CR, CR, C…
$ YOUNG            &lt;dbl&gt; NA, 1100, 0, 2620, 2840, 2910, 2850, 0, 1120, 30, NA,…
$ `ECONOMY ACTIVE` &lt;dbl&gt; NA, 3420, 50, 7500, 6260, 7560, 8340, 50, 2750, 210, …
$ AGED             &lt;dbl&gt; NA, 2110, 20, 3260, 1630, 3310, 3590, 10, 560, 50, NA…
$ TOTAL            &lt;dbl&gt; NA, 6630, 70, 13380, 10730, 13780, 14780, 60, 4430, 2…
$ DEPENDENCY       &lt;dbl&gt; NA, 0.9385965, 0.4000000, 0.7840000, 0.7140575, 0.822…
$ geometry         &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOL…</code></pre>
</div>
</div>
<div class="notes">
<p>A kind of data that is very similar to an ordinary data. The only difference is that each observation is associated with some form of geography such as numbers of aged population by planning subzone.</p>
</div>
<hr>
<section id="describing-attribute-distribution" class="level3">
<h3 class="anchored" data-anchor-id="describing-attribute-distribution">Describing attribute distribution</h3>
<p>The dependency ratio values by planning subzone are normally distributed.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Lesson06-Spatial_Weights_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<div class="notes">
<p>In statistics, we are interested to study if the observed distribution resemble normal distribution. To provide an answer to the question, we have to go beyond EDA and apply Confirmatory Data Analysis or also know as statistical test to confirm the observated pattern is indeed resemble normal distribution.</p>
</div>
<hr>
</section>
<section id="geographical-distribution-question" class="level3">
<h3 class="anchored" data-anchor-id="geographical-distribution-question">Geographical distribution question</h3>
<p>Are the planning subzones with high proportion of dependency ratio randomly distributed over space?</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Lesson06-Spatial_Weights_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<div class="notes">
<p>When come of geographically referenced attributes, beside the distribution of the value, we are also interested to find out if the observed geographical patterns are randomly distributed. Similarly to statistical, geovisualisation is not enough because the visual impression will change when different data classification methods is used.</p>
</div>
<hr>
</section>
<section id="geographical-distribution-question-1" class="level3">
<h3 class="anchored" data-anchor-id="geographical-distribution-question-1">Geographical distribution question</h3>
<p>Are the planning subzones with high proportion of dependency ratio randomly distributed over space?</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Lesson06-Spatial_Weights_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="1440"></p>
</div>
</div>
<p>]</p>
<div class="notes">
<p>As a result, a formal statistical test of spatial randomness is needed.</p>
</div>
</section>
</section>
<section id="what-are-spatial-weights-wij" class="level2">
<h2 class="anchored" data-anchor-id="what-are-spatial-weights-wij">What are Spatial Weights <em>(wij)</em></h2>
<ul>
<li>A way to define spatial neighbourhood.</li>
</ul>
<p><img src="img/image6-6.jpg" class="img-fluid"></p>
<div class="notes">
<p>Before we can perform statistics test of spatial randomness, we need to understand how spatial relationship among geographical areas can be defined mathematically.</p>
</div>
<hr>
<section id="defining-spatial-weights" class="level3">
<h3 class="anchored" data-anchor-id="defining-spatial-weights">Defining Spatial Weights</h3>
<p><img src="img/image6-7.jpg" class="img-fluid"></p>
<div class="notes">
<p>There are at least two popular methods can be used to define spatial weights of geographical areas. They are contiguity and distance. Both of them are encoded in binary.</p>
<p>According to contiguity principle, two geographical areas are consider as neighbour if they share a common boundary. Hence, if two geographical areas are neighbour, they will be indicated as 1. On the other hand, if the two geographical areas are not neighbour, they will be indicated as 0.</p>
<p>According to distance principle, two geographical areas are consider as neighbour if their centroid as within a spefic distance. Hence, if two geographical areas are neighbour, they will be indicated as 1. On the other hand, if the two geographical areas are not neighbour, they will be indicated as 0.</p>
</div>
<hr>
</section>
<section id="contiguity-neighbours" class="level3">
<h3 class="anchored" data-anchor-id="contiguity-neighbours">Contiguity Neighbours</h3>
<ul>
<li><p>Contiguity (common boundary)</p></li>
<li><p>What is a “shared” boundary?</p></li>
</ul>
<p><img src="img/image6-8.jpg" class="img-fluid"></p>
<div class="notes">
<p>This figure shows three different ways to define contiguity neighbours. They are Rooks, Bishop and Queens methods. Rooks and Queens are the two commonly used methods.<br>
The main different between Queens and Rooks is that Rooks only consider geographical areas that shared common boundaries but Queens method includes geographical areas touching at the tips of the target geographical area.</p>
</div>
<hr>
</section>
<section id="beyond-the-basic-contiguity-neighbours" class="level3">
<h3 class="anchored" data-anchor-id="beyond-the-basic-contiguity-neighbours">Beyond the basic contiguity neighbours</h3>
<p>There are also second-order, third-order, forth-order, etc contiguity</p>
<p><img src="img/image6-18.jpg" class="img-fluid"></p>
<div class="notes">
<p>The figure show contiguity neighbours beyond the first order. As you can see that the second-order contiguity neighbours are also defined according to Rooks and Queens case.</p>
</div>
<hr>
</section>
<section id="weights-matrix-adjacency-based-neighbours" class="level3">
<h3 class="anchored" data-anchor-id="weights-matrix-adjacency-based-neighbours">Weights matrix: Adjacency-based neighbours</h3>
<p><strong>Quiz</strong>: With reference to the figure below, list down the neighbour(s) of area 1202 using Rook case.</p>
<p><img src="img/image6-9.jpg" class="img-fluid"></p>
<div class="notes">
<p>This figure shows a geographical area with nine locations. Let us focus on location 1202. According to Queens case, it has seven neighbours. They are 1101, 1201, 1301, 1102, 1302, 1000, and 0901. If Rooks case is consider, 1101 and 1301 will not be considered as neighbours because they do not share common boundaries with 1202.</p>
</div>
<hr>
</section>
<section id="weights-matrix-distance-based-neighbours" class="level3">
<h3 class="anchored" data-anchor-id="weights-matrix-distance-based-neighbours">Weights Matrix: Distance-based neighbours</h3>
<p><strong>Quiz:</strong> With reference to the figure below, create a weights matrix for d = 650.</p>
<p><img src="img/image6-10.jpg" class="img-fluid"></p>
<div class="notes">
<p>In this figure, a cut-off distance of 650m is used. In this case, locations B, C and D are considered as neighbours of location A because all of them are with the 650m distance from A. On the other hand, location E is not a neighbour of location A because their distance is 757m apart.</p>
</div>
<hr>
</section>
<section id="weights-matrix-measured-distances" class="level3">
<h3 class="anchored" data-anchor-id="weights-matrix-measured-distances">Weights matrix: Measured distances</h3>
<p><img src="img/image6-11.jpg" class="img-fluid"></p>
<div class="notes">
<p>In this figure, spatial weights are calculated as the inversed function of the distance. In other word, two locations that are closer will be given higher weight than two locations that are further away. For example, the distance of AB is 353 and the diatnce of AE is 757 and the spatial weights are 0.00283 and 0.00132 respectively.</p>
</div>
<hr>
</section>
<section id="row-standardisation" class="level3">
<h3 class="anchored" data-anchor-id="row-standardisation">Row standardisation</h3>
<p>In practice, row-standardised weights instead of spatial weights will be used.</p>
<p><img src="img/image6-12.jpg" class="img-fluid"></p>
<div class="notes">
<p>Row-standardised weights increase the influence of links from observations with few neighbours, which binary weights vary the influence of observations. + Those with many neighbours are up-weighted compared to those with few. + In this case, raw 1 have four neighbours, hence each neighbour will have a value of 1/4. On the other hand, row number 2, has only two neighbour, hence each neighbour will be given a value of 1/2.</p>
</div>
</section>
</section>
<section id="applications-of-spatial-weights" class="level2">
<h2 class="anchored" data-anchor-id="applications-of-spatial-weights">Applications of Spatial Weights</h2>
<p>Formally, for observation i, the spatial lag of yi, referred to as [Wy]i (the variable Wy observed for location i) is:</p>
<p><img src="img/image6-17.jpg" class="img-fluid"></p>
<p>where the weights wij consist of the elements of the i-th row of the matrix W, matched up with the corresponding elements of the vector y.</p>
<div class="notes">
<p>With a neighbor structure defined by the non-zero elements of the spatial weights matrix W, a <strong>spatially lagged variable</strong> is a weighted sum or a weighted average of the neighboring values for that variable. In most commonly used notation, the spatial lag of y is then expressed as Wy.</p>
</div>
<hr>
<section id="spatially-lagged-variables" class="level3">
<h3 class="anchored" data-anchor-id="spatially-lagged-variables">Spatially Lagged Variables</h3>
<p>Spatial lag with row-standardized weights.</p>
<p><img src="img/image6-19.png" class="img-fluid"></p>
<div class="notes">
<p>This figure shows the spatially lagged of GPDPC summed up the GDPPC of all its neighbours except the target location itself.</p>
</div>
<hr>
</section>
<section id="spatial-window-sum" class="level3">
<h3 class="anchored" data-anchor-id="spatial-window-sum">Spatial window sum</h3>
<p>The spatial window sum uses and includes the diagonal element.</p>
<p><img src="img/image6-20.png" class="img-fluid"></p>
<div class="notes">
<p>Spatial window sum, on the other hand, summed up the GDPPC of all neighbours and include the target location itself.</p>
</div>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<ul>
<li>Chapter 2. <a href="https://www.insee.fr/en/statistiques/fichier/3635545/imet131-f-chapitre-2.pdf">Codifying the neighbourhood structure</a> of <a href="https://www.insee.fr/en/information/3635545">Handbook of Spatial Analysis: Theory and Application with R</a>.</li>
<li>François Bavaud (2010) <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1538-4632.1998.tb00394.x">“Models for Spatial Weights: A Systematic Look”</a> <em>Geographical Analysis</em>, Vol. 30, No.2, pp 153-171.</li>
<li>Tony H. Grubesic and Andrea L. Rosso (2014) <a href="https://www-jstor-org.libproxy.smu.edu.sg/stable/26326897?sid=primo&amp;seq=1#metadata_info_tab_contents">“The Use of Spatially Lagged Explanatory Variables for Modeling Neighborhood Amenities and Mobility in Older Adults”</a>, <em>Cityscape</em>, Vol. 16, No.&nbsp;2, pp.&nbsp;205-214.</li>
</ul>
<div class="cell">

</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>